<div class="d-flex justify-content-between align-items-center mb-3">
	<h3 class="m-0">Tareas</h3>
	<div>
		<button class="btn btn-outline-primary btn-sm me-2" (click)="setFilter('all')" [class.active]="filter==='all'">Todas</button>
		<button class="btn btn-outline-primary btn-sm me-2" (click)="setFilter('active')" [class.active]="filter==='active'">Activas</button>
		<button class="btn btn-outline-primary btn-sm me-2" (click)="setFilter('completed')" [class.active]="filter==='completed'">Completadas</button>
		<button class="btn btn-primary btn-sm" (click)="openCreate()">Nueva tarea</button>
	</div>
</div>

<div *ngIf="loading" class="text-center py-4">
	<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>
</div>

<div *ngIf="error" class="alert alert-danger">{{ error }}</div>

<div *ngIf="!loading && filtered.length === 0" class="text-muted">No hay tareas.</div>

<div class="row gy-3">
	<div class="col-12 col-md-6" *ngFor="let t of filtered">
		<div class="card" id="task-{{t.id}}">
			<div class="card-body d-flex">
				<div class="me-3 align-self-start">
					<input class="form-check-input" type="checkbox" [checked]="t.isCompleted" (change)="toggleComplete(t)" />
				</div>
				<div class="flex-grow-1">
					<h5 class="card-title mb-1" [class.text-decoration-line-through]="t.isCompleted">{{ t.title }}</h5>
					<p class="card-text small text-muted mb-1">{{ t.description }}</p>
					<p class="card-text small text-muted">Creada: {{ t.createdAt | date:'short' }}</p>
				</div>
				<div class="ms-3 d-flex flex-column gap-2">
					<button class="btn btn-sm btn-outline-secondary" (click)="openEdit(t)">Editar</button>
					<button class="btn btn-sm btn-outline-danger" (click)="deleteTask(t)">Borrar</button>
				</div>
			</div>
		</div>
	</div>
</div>
